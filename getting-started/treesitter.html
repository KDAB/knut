
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Knut Documentation - Automation tool for code transformation using scripts">
      
      
        <meta name="author" content="KlarÃ¤lvdalens Datakonsult AB (KDAB)">
      
      
        <link rel="canonical" href="https://kdab.github.io/knut/getting-started/treesitter.html">
      
      
        <link rel="prev" href="script.html">
      
      
        <link rel="next" href="cli.html">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.28">
    
    
      
        <title>Syntax tree queries - Knut - Code transformation via scripts</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="kdab" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#syntax-tree-queries-using-tree-sitter" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="Knut - Code transformation via scripts" class="md-header__button md-logo" aria-label="Knut - Code transformation via scripts" data-md-component="logo">
      
  <img src="../assets/transparentWhiteKDAB.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Knut - Code transformation via scripts
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Syntax tree queries
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="kdab" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/KDAB/Knut" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Knut
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../index.html" class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="overview.html" class="md-tabs__link">
          
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../contributing/getting-involved.html" class="md-tabs__link">
          
  
  Contributing

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../API/script/document.html" class="md-tabs__link">
          
  
  Script API

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="Knut - Code transformation via scripts" class="md-nav__button md-logo" aria-label="Knut - Code transformation via scripts" data-md-component="logo">
      
  <img src="../assets/transparentWhiteKDAB.svg" alt="logo">

    </a>
    Knut - Code transformation via scripts
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/KDAB/Knut" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Knut
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="overview.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="script.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Writing a script
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Syntax tree queries
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="treesitter.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Syntax tree queries
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tree-sitter-in-knut" class="md-nav__link">
    <span class="md-ellipsis">
      Tree-sitter in Knut
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#writing-tree-sitter-queries" class="md-nav__link">
    <span class="md-ellipsis">
      Writing Tree-sitter queries
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#predicates" class="md-nav__link">
    <span class="md-ellipsis">
      Predicates
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Predicates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exclude-capture-exclusion" class="md-nav__link">
    <span class="md-ellipsis">
      (exclude! [capture]+ [exclusion]+)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eq-args" class="md-nav__link">
    <span class="md-ellipsis">
      (#eq? [args]+)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#like-args" class="md-nav__link">
    <span class="md-ellipsis">
      (like? [args]+)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eq_except-pattern-capture-exclusion" class="md-nav__link">
    <span class="md-ellipsis">
      (eq_except? [pattern] [capture] [exclusion]+)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#like_except-pattern-capture-exclusion" class="md-nav__link">
    <span class="md-ellipsis">
      (like_except? [pattern] [capture] [exclusion]+)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#match-regex-args" class="md-nav__link">
    <span class="md-ellipsis">
      (#match? [regex] [args]+)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#not_is-capture-node_type" class="md-nav__link">
    <span class="md-ellipsis">
      (#not_is? [capture]+ [node_type]+)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#in_message_map-capture" class="md-nav__link">
    <span class="md-ellipsis">
      (#in_message_map? [capture]+)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="cli.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Command line interface
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="gui.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User interface
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Contributing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/getting-involved.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting involved
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/architecture.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Architecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/unit-tests.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Unit tests
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Script API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Script API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Script Module
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Script Module
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/document.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Document
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/project.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Project
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_3" >
        
          
          <label class="md-nav__link" for="__nav_4_1_3" id="__nav_4_1_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    CodeDocument
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_3">
            <span class="md-nav__icon md-icon"></span>
            CodeDocument
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/codedocument.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CodeDocument
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/classsymbol.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ClassSymbol
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/functionargument.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FunctionArgument
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/functionsymbol.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FunctionSymbol
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/querycapture.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QueryCapture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/querymatch.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QueryMatch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/symbol.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Symbol
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_4" >
        
          
          <label class="md-nav__link" for="__nav_4_1_4" id="__nav_4_1_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    CppDocument
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_4">
            <span class="md-nav__icon md-icon"></span>
            CppDocument
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/cppdocument.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CppDocument
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/dataexchange.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DataExchange
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/dataexchangeentry.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DataExchangeEntry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/messagemap.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MessageMap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/messagemapentry.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MessageMapEntry
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_5" >
        
          
          <label class="md-nav__link" for="__nav_4_1_5" id="__nav_4_1_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    QtTsDocument
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_5">
            <span class="md-nav__icon md-icon"></span>
            QtTsDocument
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/qttsdocument.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QtTsDocument
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/qttsmessage.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QtTsMessage
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_6" >
        
          
          <label class="md-nav__link" for="__nav_4_1_6" id="__nav_4_1_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    QtUiDocument
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_6">
            <span class="md-nav__icon md-icon"></span>
            QtUiDocument
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/qtuidocument.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QtUiDocument
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/qtuiwidget.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QtUiWidget
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_7" >
        
          
          <label class="md-nav__link" for="__nav_4_1_7" id="__nav_4_1_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    RcDocument
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_7">
            <span class="md-nav__icon md-icon"></span>
            RcDocument
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/rcdocument.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RcDocument
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/action.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Action
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/asset.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Asset
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/menu.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Menu
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/menuitem.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MenuItem
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/ribbon.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ribbon
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/ribboncategory.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RibbonCategory
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/ribboncontext.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RibbonContext
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/ribbonelement.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RibbonElement
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/ribbonmenu.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RibbonMenu
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/ribbonpanel.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RibbonPanel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/shortcut.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Shortcut
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/string.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    String
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/toolbar.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ToolBar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/toolbaritem.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ToolBarItem
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/widget.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Widget
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_8" >
        
          
          <label class="md-nav__link" for="__nav_4_1_8" id="__nav_4_1_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    TextDocument
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_8">
            <span class="md-nav__icon md-icon"></span>
            TextDocument
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/textdocument.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TextDocument
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/mark.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mark
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/rangemark.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RangeMark
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/textlocation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TextLocation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/textrange.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TextRange
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_9" >
        
          
          <label class="md-nav__link" for="__nav_4_1_9" id="__nav_4_1_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Items
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_9">
            <span class="md-nav__icon md-icon"></span>
            Items
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/script.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Script
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/scriptdialog.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ScriptDialog
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_10" >
        
          
          <label class="md-nav__link" for="__nav_4_1_10" id="__nav_4_1_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Utilities
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_10">
            <span class="md-nav__icon md-icon"></span>
            Utilities
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/dir.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dir
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/file.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/fileinfo.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FileInfo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/message.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Message
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/settings.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Settings
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/userdialog.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UserDialog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/utils.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/qdirvaluetype.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QDirValueType
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script/qfileinfovaluetype.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QFileInfoValueType
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Script.Test Module
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Script.Test Module
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script.test/testcase.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TestCase
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/script.test/testutil.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TestUtil
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tree-sitter-in-knut" class="md-nav__link">
    <span class="md-ellipsis">
      Tree-sitter in Knut
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#writing-tree-sitter-queries" class="md-nav__link">
    <span class="md-ellipsis">
      Writing Tree-sitter queries
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#predicates" class="md-nav__link">
    <span class="md-ellipsis">
      Predicates
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Predicates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exclude-capture-exclusion" class="md-nav__link">
    <span class="md-ellipsis">
      (exclude! [capture]+ [exclusion]+)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eq-args" class="md-nav__link">
    <span class="md-ellipsis">
      (#eq? [args]+)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#like-args" class="md-nav__link">
    <span class="md-ellipsis">
      (like? [args]+)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eq_except-pattern-capture-exclusion" class="md-nav__link">
    <span class="md-ellipsis">
      (eq_except? [pattern] [capture] [exclusion]+)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#like_except-pattern-capture-exclusion" class="md-nav__link">
    <span class="md-ellipsis">
      (like_except? [pattern] [capture] [exclusion]+)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#match-regex-args" class="md-nav__link">
    <span class="md-ellipsis">
      (#match? [regex] [args]+)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#not_is-capture-node_type" class="md-nav__link">
    <span class="md-ellipsis">
      (#not_is? [capture]+ [node_type]+)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#in_message_map-capture" class="md-nav__link">
    <span class="md-ellipsis">
      (#in_message_map? [capture]+)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="syntax-tree-queries-using-tree-sitter">Syntax tree queries using Tree-sitter<a class="headerlink" href="#syntax-tree-queries-using-tree-sitter" title="Permanent link">#</a></h1>
<p>Knut uses Tree-sitter to build a syntax tree of your files and query data from it.</p>
<p>From the <a href="https://tree-sitter.github.io/tree-sitter/">Tree-sitter website</a>:</p>
<blockquote>
<p>Tree-sitter is a parser generator tool and an incremental parsing library.
It can build a concrete syntax tree for a source file and efficiently update the syntax tree as the source file is edited.</p>
<p>Tree-sitter aims to be:</p>
<ul>
<li><strong>General</strong> enough to parse any programming language</li>
<li><strong>Fast</strong> enough to parse on every keystroke in a text editor</li>
<li><strong>Robust</strong> enough to provide useful results even in the presence of syntax errors</li>
<li><strong>Dependency-free</strong> so that the runtime library (which is written in pure C) can be embedded in any application</li>
</ul>
</blockquote>
<h2 id="tree-sitter-in-knut">Tree-sitter in Knut<a class="headerlink" href="#tree-sitter-in-knut" title="Permanent link">#</a></h2>
<p>Current support in user scripts is limited to:</p>
<ul>
<li>Inspecting the concrete syntax tree generated by Tree-sitter using the "Tree-sitter Inspector".</li>
<li>Running <a href="https://tree-sitter.github.io/tree-sitter/using-parsers#pattern-matching-with-queries">Tree-sitter Queries</a></li>
<li>Only available on C/C++ files</li>
</ul>
<p>However, this already allows for some very easy &amp; powerful analysis and modification of C++ source files.</p>
<p>Knut also returns Tree-sitter query results in some of its high-level methods.
Usually in the form of the <a href="../API/script/querymatch.html">QueryMatch</a> class.</p>
<p>See the <a href="../API/script/querymatch.html">QueryMatch documentation</a> for more details of how to use this class.</p>
<p>Compared to the language server, Tree-sitter is a lot more resistant to errors and works well, even if the current code would not compile.
For this reason many Knut functions internally rely on Tree-sitter instead of the language server.
This may result in false-positives though, as Tree-sitter only works on a syntax level and doesn't understand the high-level structures of the code.
Tree-sitter will especially struggle if symbols are overloaded, as all references may be picked up.</p>
<h2 id="writing-tree-sitter-queries">Writing Tree-sitter queries<a class="headerlink" href="#writing-tree-sitter-queries" title="Permanent link">#</a></h2>
<p>Tree-sitter queries are a powerful tool, as the syntax tree parsed by Tree-sitter makes it easy to find functions, class definitions, etc.
For the exhaustive specification of the query syntax, see the <a href="https://tree-sitter.github.io/tree-sitter/using-parsers#pattern-matching-with-queries">Tree-sitter website</a>.</p>
<p>Knut supports prototyping queries with the <code>Tree-sitter Inspector</code>, which can be accessed in the Knut GUI under the <code>C++</code> menu.</p>
<p>The Tree-sitter Inspector allows you to inspect the syntax tree of the current file.
Note that this does not include anonymous nodes (e.g. any symbols like -&gt; * + - / ).
These are still in the syntax tree and can be queried.
For details, see the <a href="https://tree-sitter.github.io/tree-sitter/using-parsers#pattern-matching-with-queries">query documentation</a>.</p>
<p>As the syntax tree can become large very quickly, the Inspector provides a bi-directional mapping to the edited file.</p>
<ol>
<li>Clicking any node in the inspector will select the corresponding text in the document</li>
<li>Any node that includes the cursor position is highlighted in green.</li>
</ol>
<p>Additionally, you can test your queries in the bottom-left input field.
The Tree-sitter Inspector will notify you of errors in your query and display the number of patterns, matches and captures as you type.
Any captured nodes will also display their captures in the syntax tree view.</p>
<p>After prototyping a query, it can easily be included in a script by calling <a href="../API/script/codedocument.html#query"><code>query</code></a> on any LSP capable document (e.g. C/C++).
Together with Javascripts <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment?retiredLocale=de">Destructuring Assignment</a> and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals?retiredLocale=de">Template Literals</a> this makes queries very ergonomic to use in your own scripts.</p>
<p>Example:
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">className</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="cm">/*...*/</span><span class="p">;</span>

<span class="c1">//  Destructuring Assignment with [ ] can be used if only one result is expected.</span>
<span class="kd">let</span><span class="w"> </span><span class="p">[</span><span class="kr">constructor</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">cppFile</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="sb">`</span>
<span class="sb">    (function_definition</span>
<span class="sb">        declarator: (function_declarator</span>
<span class="sb">            declarator: (qualified_identifier</span>
<span class="sb">                scope: (_) @scope</span>
<span class="sb">                (identifier) @name)</span>
<span class="sb">                (#eq? &quot;</span><span class="si">${</span><span class="nx">className</span><span class="si">}</span><span class="sb">&quot; @scope @name))</span>
<span class="sb">        body: (compound_statement) @body)</span>
<span class="sb">`</span><span class="p">);</span>
<span class="c1">//                     ^^^^^^^^^^^^</span>
<span class="c1">// Note how className was entered directly into the query using the ${...} syntax.</span>

<span class="c1">// The result will be an empty list if nothing was found.</span>
<span class="c1">// When using destructuring assignment, constructor will then be undefined.</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="kr">constructor</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">Message</span><span class="p">.</span><span class="nx">warning</span><span class="p">(</span><span class="sb">`Cannot find constructor for class </span><span class="si">${</span><span class="nx">className</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Get the text of a capture</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">old_body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">constructor</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">).</span><span class="nx">text</span><span class="p">;</span>

<span class="c1">// Modify a capture</span>
<span class="kr">constructor</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sb">`{</span>
<span class="sb">    std::log &lt;&lt; &quot;</span><span class="si">${</span><span class="nx">className</span><span class="si">}</span><span class="sb"> Constructor&quot; &lt;&lt; std::endl;</span>
<span class="sb">}`</span><span class="p">);</span>

<span class="c1">// Or remove it outright</span>
<span class="kr">constructor</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">).</span><span class="nx">remove</span><span class="p">()</span>
</code></pre></div></p>
<h2 id="predicates">Predicates<a class="headerlink" href="#predicates" title="Permanent link">#</a></h2>
<p>Tree-sitter queries can be extended by the embedding application (in this case Knut) using predicates.</p>
<p>The predicates provided by Knut are divided into two categories:</p>
<ol>
<li>Commands - Predicates ending with an exclamation mark (<code>!</code>)<ul>
<li>These predicates may modify a QueryMatch, but not discard it</li>
<li>Commands are run <em>before</em> the filters are checked</li>
</ul>
</li>
<li>Filters - Predicates ending with a question mark (<code>?</code>)<ul>
<li>These predicates can discard, but not modify a QueryMatch</li>
<li>A filter discards a QueryMatch if its check fails</li>
<li>Filters are checked <em>after</em> the commands run</li>
</ul>
</li>
</ol>
<p>Knut currently provides implementations for these predicates:</p>
<h3 id="exclude-capture-exclusion"><code>(exclude! [capture]+ [exclusion]+)</code><a class="headerlink" href="#exclude-capture-exclusion" title="Permanent link">#</a></h3>
<p>Exclude node types listed in <code>exclusion</code> from the given <code>capture</code>s.</p>
<p>This is especially useful to remove any unwanted <code>(comment)</code> nodes.
Especially when transforming function calls, this is helpful, as the order of arguments is often relevant there and inline comments should likely not be treated as positional arguments.</p>
<p>Example:
<div class="highlight"><pre><span></span><code>(call_expression
    function: (identifier) @name (#eq? @name myFunction)
    arguments: (argument_list
        [(_) @argument &quot;,&quot;]*)
    (#exclude! @argument comment))
</code></pre></div>
This query would return a QueryMatch with only 2 captures for "argument" on the following call:
<div class="highlight"><pre><span></span><code>myFunction(1, /*documentation for the second parameter*/ 2);
</code></pre></div></p>
<p>Where the first <code>@argument</code> capture would be <code>"1"</code> and the second <code>"2"</code>.</p>
<p>Without the <code>(#exclude!)</code> predicate, 3 nodes would have been captured, with the comment as the second capture.</p>
<h3 id="eq-args"><code>(#eq? [args]+)</code><a class="headerlink" href="#eq-args" title="Permanent link">#</a></h3>
<p>Check if all arguments are exactly string-equal</p>
<p>Example usage to find the constructor of <code>MyClass</code>
<div class="highlight"><pre><span></span><code>(function_definition
    declarator: (function_declarator
        declarator: (qualified_identifier
            scope: (_) @scope
            (identifier) @name)
            (#eq? &quot;MyClass&quot; @scope @name))
    body: (compound_statement) @body)
</code></pre></div>
Would find the constructor of the class <code>MyClass</code>.</p>
<h3 id="like-args"><code>(like? [args]+)</code><a class="headerlink" href="#like-args" title="Permanent link">#</a></h3>
<p>Check if all arguments are "alike".</p>
<p>In this case "alike" means the arguments are all string-equal, after all white-space is removed.</p>
<p>This is very useful when comparing strings that might span multiple lines or may be indented/formatted differently depending on preference.
E.g. <code>const QString&amp;</code> could also be formatted as <code>const QString &amp;</code>.
The <code>like?</code> predicate would match both of these variations.</p>
<p>In general, prefer <code>like?</code> over <code>eq?</code> when matching anything other than a single identifier.</p>
<h3 id="eq_except-pattern-capture-exclusion"><code>(eq_except? [pattern] [capture] [exclusion]+)</code><a class="headerlink" href="#eq_except-pattern-capture-exclusion" title="Permanent link">#</a></h3>
<p>Check if the pattern and the capture are string-equal, excluding any (sub-)nodes that have a type listed in <code>exclusion</code>.</p>
<p>This is similar to the <code>(#eq?)</code> operator.
However, the captured nodes and their child nodes are filtered.
Any (child) node listed in <code>exclusion</code> is removed from the string before comparing for string-equality.</p>
<p>This is useful to remove the <code>identifier</code> from a parameter_declaration, that may have arbitrarily many pointer indirections.</p>
<p>E.g.: To check that the type of a parameter is <code>const std::string &amp;</code>, you can simply exclude the identifier:
<div class="highlight"><pre><span></span><code>(function_definition
    declarator: (function_declarator
        parameters: (parameter_list
            (parameter_declaration) @param
            (#eq_except? &quot;const std::string &amp;&quot; @param &quot;identifier&quot;))))
</code></pre></div></p>
<h3 id="like_except-pattern-capture-exclusion"><code>(like_except? [pattern] [capture] [exclusion]+)</code><a class="headerlink" href="#like_except-pattern-capture-exclusion" title="Permanent link">#</a></h3>
<p>Check if the pattern and capture are "alike", excluding any (sub-)nodes that have a type listed in <code>exclusion</code>.</p>
<p>See: <a href="#eq_except-pattern-capture-exclusion"><code>(#eq_except?)</code></a> and <a href="#like-args"><code>(#like?)</code></a>.</p>
<h3 id="match-regex-args"><code>(#match? [regex] [args]+)</code><a class="headerlink" href="#match-regex-args" title="Permanent link">#</a></h3>
<p>Check if the given <code>args</code> match the given <code>regex</code></p>
<p>Example usage to find all member function definitions of <code>MyClass</code>
<div class="highlight"><pre><span></span><code>(function_definition
    declarator: (function_declarator
        declarator: (_) @name
            (#match? &quot;MyClass::&quot; @name))
    body: (compound_statement) @body)
</code></pre></div></p>
<h3 id="not_is-capture-node_type"><code>(#not_is? [capture]+ [node_type]+)</code><a class="headerlink" href="#not_is-capture-node_type" title="Permanent link">#</a></h3>
<p>Check that <strong>none</strong> of the captures are of any of the given node types.</p>
<p>This is especially useful when using the wildcard operators <code>(_)</code> and <code>_</code>.
These match any (named) node type. Combined with this predicate these can match any node type <em>but</em> the given types.</p>
<p>Example usage to find all member functions that return any type <em>other</em> than a primitive type:
<div class="highlight"><pre><span></span><code>(function_definition
    type: (_) @type
    (#not_is? @type primitive_type)) @function
</code></pre></div></p>
<h3 id="in_message_map-capture"><code>(#in_message_map? [capture]+)</code><a class="headerlink" href="#in_message_map-capture" title="Permanent link">#</a></h3>
<p>Check if the given capture is within a MFC message map.</p>
<p>Example usage to find all elements of the message map:
<div class="highlight"><pre><span></span><code>(
(expression_statement) @expr
(#in_message_map? @expr)
)
</code></pre></div>
Note that for most operations, using <a href="../API/script/cppdocument.html#mfcExtractMessageMap"><code>CppDocument::mfcExtractMessageMap</code></a> is probably easier.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; Klar&auml;lvdalens Datakonsult AB (KDAB)<br>Trusted Software Excellence<br><a href='https://www.kdab.com'>https://www.kdab.com/</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.top", "navigation.tabs", "navigation.tabs.sticky"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
    
  </body>
</html>